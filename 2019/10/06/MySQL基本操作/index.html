<!DOCTYPE html>

<html lang="zh-Hans">
    <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <!--
        © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
        Version: 1.3.3
    -->
    <script>
window.lsVersion = "1.3.3",
window.oldVersion = [
    
        
            "0.2.0","0.0.1","0.1.0","1.0.0","1.0.1","1.1.0","1.1.1","1.2.0","1.3.0","1.3.2"
        
    
]
</script>

    <!-- ### DNS Prefetch ### -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
<!-- busuanzi -->

    <link rel="dns-prefetch" href="//busuanzi.ibruce.info">


<!-- comment -->







<!-- analytics -->








    <!-- ### Preload ### -->
    
    <!-- Busuanzi -->
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" as="script">







    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge, chrome=1">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

<!-- Title -->
<title>MySQL基本操作 | 小尹的博客</title>

<!-- favicon -->
<!-- Favicons -->

    <link rel="icon" type="image/ico" href="/img/suka-favicon.ico">






<!-- Android Chrome Color -->



<meta name="format-detection" content="telephone=no">

<!-- Description -->
<meta name="description" content="SQL 概述简述：

提出：Boyce &amp;amp;...">

<!-- Keywords -->
<meta name="keywords" content=", MySQL, 数据库">

<!-- Disable Fucking Bloody Baidu Tranformation -->
<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

    <!-- ### Import File ### -->
    
        <!-- spectre.css -->

    <link rel="stylesheet" href="/lib/spectre/spectre.min.css">


<style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #0070ff;
    }

    a:active, a:focus, a:hover {
        color: #0070ff;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    .post-entry .card-body a {
        color: #0070ff;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #0070ff;
    }

    .navbar-link:hover {
        color: #0070ff;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style>

<!-- style.css -->

    <link rel="stylesheet" href="/css/style.min.css">









    <!-- Prettify Theme -->
    
    
        <link rel="stylesheet" href="/css/highlight/github.min.css">
    



    

    <!-- ### Site Verification ### -->
    


    <!-- ### RSS ### -->
    

    <!-- ### WebApp ### -->
    <meta name="mobile-web-app-capable" content="yes">
<meta name="application-name" content="小尹的博客">
<meta name="msapplication-starturl" content="https://boysg.github.io">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="小尹的博客">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Manifest Import -->

<!-- Open Search -->


    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="MySQL基本操作 | 小尹的博客">
<meta property="og:site_name" content="小尹的博客">

<meta property="og:locale" content="zh-Hans">

<meta property="og:url" content="https://boysg.github.io/2019/10/06/MySQL基本操作/">
<meta property="og:image" content="https://boysg.github.io/img/suka-favicon.ico">

<meta property="og:description" content="SQL 概述简述：

提出：Boyce &amp;amp;...">

<meta name="twitter:card" content="summary">


    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2019-10-06T15:47:42.000Z">
    <meta property="article:modified_time" content="2019-10-06T15:47:42.000Z">
    <meta property="article:author" content="Sugarman">
    <meta property="og:article:tag" content=", MySQL, 数据库"> 





    <!-- ### Analytics ### -->
    








    <!-- ### Canonical link ### -->
    <link rel="canonical" href="https://boysg.github.io/2019/10/06/MySQL基本操作/">

    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "https://boysg.github.io/2019/10/06/MySQL基本操作/",
    "@type": "BlogPosting",
    "logo": "https://boysg.github.io/img/suka-favicon.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://boysg.github.io/2019/10/06/MySQL基本操作/"
    },
    "headline": "MySQL基本操作 | 小尹的博客",
    
    "image": {
        "@type": "ImageObject",
        "url": "https://boysg.github.io/img/suka-favicon.ico"
    },
    
    "datePublished": "2019-10-06T15:47:42.000Z",
    "dateModified": "2019-10-17T16:00:31.797Z",
    "author": {
        "@type": "Person",
        "name": "Sugarman",
        "image": {
            "@type": "ImageObject",
            "url": "https://boysg.github.io/img/default_avatar.png"
        },
        "description": "Hi, nice to meet you."
    },
    "publisher": {
        "@type": "Organization",
        "name": "小尹的博客",
        "logo": {
            "@type": "ImageObject",
            "url": "https://boysg.github.io/img/suka-favicon.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "https://boysg.github.io/search?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": ", MySQL, 数据库",
    "description": "SQL 概述简述：

提出：Boyce &amp;amp;..."
}
</script>



    <!-- ### Custom Head ### -->
    


</head>

    <body>
        

            

            <!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/">小尹的博客</a></h1>

    <p class="text-center header-slogan">
        
            
                Hi, nice to meet you.
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/" class="navbar-link">首页</a>
    
    
        <a href="/archives/" class="navbar-link">归档</a>
    
    
        <a href="/search" class="navbar-link">搜索</a>
    
    
    
        <div class="dropdown dropdown-right">
    <a class="navbar-link dropdown-toggle" tabindex="0">分享</a>
    <ul class="menu share-menu">

        <!-- Share Weibo -->
        
        <li class="menu-item">
            <a href="http://service.weibo.com/share/share.php?appkey=&title=小尹的博客&url=https://boysg.github.io&pic=https://boysg.github.io/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">分享到微博</a>
        </li>
        

        <!-- Share Twitter -->
        
        <li class="menu-item">
            <a href="https://twitter.com/intent/tweet?text=小尹的博客&url=https://boysg.github.io&via=Sugarman" target="_blank" rel="external noopener noreferrer nofollow">分享到 Twitter</a>
        </li>
        

        <!-- Share Facebook -->
        
        <li class="menu-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://boysg.github.io" target="_blank" rel="external noopener noreferrer nofollow">分享到 Facebook</a>
        </li>
        

        <!-- Share Google+ -->
        
        <li class="menu-item">
            <a href="https://plus.google.com/share?url=https://boysg.github.io" target="_blank" rel="external noopener noreferrer nofollow">分享到 Google+</a>
        </li>
        

        <!-- Share LinkedIn -->
        
        <li class="menu-item">
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://boysg.github.io&title=MySQL基本操作" target="_blank" rel="external noopener noreferrer nofollow">分享到 LinkedIn</a>
        </li>
        

        <!-- Share QQ -->
        
        <li class="menu-item">
            <a href="http://connect.qq.com/widget/shareqq/index.html?site=小尹的博客&title=MySQL基本操作&summary=XiaoYin&pics=https://boysg.github.io/img/suka-favicon.ico&url=https://boysg.github.io" target="_blank" rel="external noopener noreferrer nofollow"> 分享到 QQ</a>
        </li>
        

        <!-- Share Telegram -->
        
        <li class="menu-item">
            <a href="https://t.me/share/url?url=https://boysg.github.io&text=MySQL基本操作" target="_blank" rel="external noopener noreferrer nofollow">分享到 Telegram</a>
        </li>
        

        <!-- QRCode -->
        
        <li class="menu-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJQAAACUCAAAAABQV18IAAAB3klEQVR42u3aQZKDMAxEUe5/6cmWSVnqL8ICN81mpiDBL1VCtmSOvwceR1BBBRXUAnU0x/n6vy+frq0+szqvxgnKC7UMuuJ8Ndjqf3K/oHxRqwDvbvh9vfp+9VAsxwnqFSiSSKsf0t0vqHejqoGq71WTc1DvQlXJsVu8dQm0G/znVUJQj0eRm93x99ZqJqjHomTToVjsrYJcJcfbui5BPRrVNS9U4NPFXRvcJKMHtRWqKggmBalqcnTFRvn0BbU1igQ2WeR1WNRAC8oK1QUmCXA6eY9XCUFth5o2Tq9sFJFzQXmhSNOUNtNIspUTclB2KNqcV03aalFXfTYoD5SaeGmjnmwqdfCg/FC0cT9taJDNgqC8UJPJlza/VCGCJuSgtkaRgyRTtfiTG5JBWaDIhEkKAlVokoAPyg+lGmcTuNqMwoEe1HYoOpAqQlUy7hpzQXmhxgXj8CVVtXEelD/qCpYuBGVyDcoCpRIiCWj60o3cJAjKAkWasV2hSRaEl5NnUFuiJgFJHgiyYf5T1yWoLVAkwAlS3Ue9jBOUF2rS2FeNe7VIHL0VFJQdSm06kg0j1UgJ6p0oGuT0xa6g/FFqIiUJVcFkkRKUDWrciIAv4NCiNigv1JOOoIIKKqjT8QEubYA/yF22egAAAABJRU5ErkJggg==" alr="QRCode">
        </li>
        

    </ul>
</div>
    
    
</nav>
</header>

            
    <!-- ## Post ## -->
    
    


<div class="post-container">
    <div id="post-card" class="card">
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">MySQL基本操作</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/img/default_avatar.png" src="/img/suka-lazyload.gif" alt="Sugarman's Avatar">
        <span>2019-10-06</span>
        
            <span class="suka-devide-dot"></span>
            <a class="category-link" href="/categories/数据库系统原理/">数据库系统原理</a>
        
        
            <!-- Busuanzi Post Views -->
<span id="busuanzi_container_page_pv" hidden>
    <span class="suka-devide-dot"></span>
    <span></span>
    <span id="busuanzi_value_page_pv"></span>
    <span>Views</span>
</span>
        
        
    </p>
    <div class="post-header-info-right">
        
            <div class="dropdown dropdown-right">
<a class="dropdown-toggle" tabindex="0">分享本文</a>
<ul class="menu share-menu">
    <!-- Share Weibo -->
    
    <li class="menu-item">
        <a href="http://service.weibo.com/share/share.php?appkey=&title=MySQL基本操作&url=https://boysg.github.io/2019/10/06/MySQL基本操作/&pic=https://boysg.github.io/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">分享到微博</a>
    </li>
    

    <!-- Share Twitter -->
    
    <li class="menu-item">
        <a href="https://twitter.com/intent/tweet?text=MySQL基本操作&url=https://boysg.github.io/2019/10/06/MySQL基本操作/&via=Sugarman" target="_blank" rel="external noopener noreferrer nofollow">分享到 Twitter</a>
    </li>
    

    <!-- Share Facebook -->
    
    <li class="menu-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://boysg.github.io/2019/10/06/MySQL基本操作/" target="_blank" rel="external noopener noreferrer nofollow">分享到 Facebook</a>
    </li>
    

    <!-- Share Google+ -->
    
    <li class="menu-item">
        <a href="https://plus.google.com/share?url=https://boysg.github.io/2019/10/06/MySQL基本操作/" target="_blank" rel="external noopener noreferrer nofollow">分享到 Google+</a>
    </li>
    

    <!-- Share LinkedIn -->
    
    <li class="menu-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://boysg.github.io/2019/10/06/MySQL基本操作/&title=小尹的博客" target="_blank" rel="external noopener noreferrer nofollow">分享到 LinkedIn</a>
    </li>
    

    <!-- Share QQ -->
    
    <li class="menu-item">
        <a href="http://connect.qq.com/widget/shareqq/index.html?site=小尹的博客&title=小尹的博客&summary=XiaoYin&pics=https://boysg.github.io/img/suka-favicon.ico&url=https://boysg.github.io/2019/10/06/MySQL基本操作/" target="_blank" rel="external noopener noreferrer nofollow"> 分享到 QQ</a>
    </li>
    

    <!-- Share Telegram -->
    
    <li class="menu-item">
        <a href="https://t.me/share/url?url=https://boysg.github.io/2019/10/06/MySQL基本操作/&text=小尹的博客" target="_blank" rel="external noopener noreferrer nofollow">分享到 Telegram</a>
    </li>
    

    <!-- QRCode -->
    
    <li class="menu-item">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJQAAACUCAAAAABQV18IAAAB3klEQVR42u3aQZKDMAxEUe5/6cmWSVnqL8ICN81mpiDBL1VCtmSOvwceR1BBBRXUAnU0x/n6vy+frq0+szqvxgnKC7UMuuJ8Ndjqf3K/oHxRqwDvbvh9vfp+9VAsxwnqFSiSSKsf0t0vqHejqoGq71WTc1DvQlXJsVu8dQm0G/znVUJQj0eRm93x99ZqJqjHomTToVjsrYJcJcfbui5BPRrVNS9U4NPFXRvcJKMHtRWqKggmBalqcnTFRvn0BbU1igQ2WeR1WNRAC8oK1QUmCXA6eY9XCUFth5o2Tq9sFJFzQXmhSNOUNtNIspUTclB2KNqcV03aalFXfTYoD5SaeGmjnmwqdfCg/FC0cT9taJDNgqC8UJPJlza/VCGCJuSgtkaRgyRTtfiTG5JBWaDIhEkKAlVokoAPyg+lGmcTuNqMwoEe1HYoOpAqQlUy7hpzQXmhxgXj8CVVtXEelD/qCpYuBGVyDcoCpRIiCWj60o3cJAjKAkWasV2hSRaEl5NnUFuiJgFJHgiyYf5T1yWoLVAkwAlS3Ue9jBOUF2rS2FeNe7VIHL0VFJQdSm06kg0j1UgJ6p0oGuT0xa6g/FFqIiUJVcFkkRKUDWrciIAv4NCiNigv1JOOoIIKKqjT8QEubYA/yF22egAAAABJRU5ErkJggg==" alt="QRCode">
    </li>
    

</ul>
</div>
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                            <div id="post-toc">
                                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SQL-概述"><span class="post-toc-number">1.</span> <span class="post-toc-text">SQL 概述</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MySQL中的SQL"><span class="post-toc-number">2.</span> <span class="post-toc-text">MySQL中的SQL</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#遵循SQL标准部分"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">遵循SQL标准部分</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#扩展部分"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">扩展部分</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#数据定义"><span class="post-toc-number">3.</span> <span class="post-toc-text">数据定义</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#数据库定义"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">数据库定义</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#常用数据类型"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">常用数据类型</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#表定义"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">表定义</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#索引"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">索引</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#索引概述"><span class="post-toc-number">3.4.1.</span> <span class="post-toc-text">索引概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#索引定义"><span class="post-toc-number">3.4.2.</span> <span class="post-toc-text">索引定义</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#数据更新"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">数据更新</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#数据查询"><span class="post-toc-number">3.6.</span> <span class="post-toc-text">数据查询</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#LIMITE"><span class="post-toc-number">3.6.1.</span> <span class="post-toc-text">LIMITE</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#视图"><span class="post-toc-number">3.7.</span> <span class="post-toc-text">视图</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#视图概述"><span class="post-toc-number">3.7.1.</span> <span class="post-toc-text">视图概述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#视图定义"><span class="post-toc-number">3.7.2.</span> <span class="post-toc-text">视图定义</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#数据库编程"><span class="post-toc-number">4.</span> <span class="post-toc-text">数据库编程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#存储过程"><span class="post-toc-number">4.0.1.</span> <span class="post-toc-text">存储过程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#存储过程概述"><span class="post-toc-number">4.0.1.1.</span> <span class="post-toc-text">存储过程概述</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#存储过程操作"><span class="post-toc-number">4.0.1.2.</span> <span class="post-toc-text">存储过程操作</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#存储函数"><span class="post-toc-number">4.0.2.</span> <span class="post-toc-text">存储函数</span></a></li></ol></li></ol></li></ol>
                            </div>
                        
                    
                    <article id="post-content">
                        <h2 id="SQL-概述"><a href="#SQL-概述" class="headerlink" title="SQL 概述"></a>SQL 概述</h2><p>简述：</p>
<ul>
<li>提出：Boyce &amp; Chamberlin in 1974</li>
<li>实现：IBM研制的System R系统</li>
<li>发展：1986年ANSI颁布 -&gt; 1987年ISO采纳为国际标准 -&gt; SQL-89 -&gt; SQL-92(SQL2) -&gt; SQL-99(SQL3)</li>
</ul>
<p>组成：</p>
<ul>
<li><p>数据定义语言（Data Definition Language, DLL）</p>
<p>作用于数据库或数据库对象（表、约束、规则、视图、触发器、存储过程）</p>
<p>CREATE 创建；ALTER 修改；DROP 删除</p>
</li>
<li><p>数据操纵语言（Data Manipulation Language, DML）</p>
<p>作用于表或视图</p>
<p>SELECT 检索；INSERT 插入；UPDATE 修改；DELETE 删除</p>
</li>
<li><p>数据控制语言（Data Control Language, DCL）</p>
<p>用于安全（权限）管理</p>
<p>GRANT 授予权限；REMOVE 收回权限</p>
</li>
<li><p>嵌入式和动态SQL规则：规定SQL语句在高级程序设计语言中使用的规范方法</p>
</li>
<li><p>SQL调用和会话规则</p>
<p>SQL调用包括SQL例程和调用规则，使SQL具有更多高级语言特征；SQL会话规则可使应用程序连接到多个SQL服务器中的某一个</p>
</li>
</ul>
<h2 id="MySQL中的SQL"><a href="#MySQL中的SQL" class="headerlink" title="MySQL中的SQL"></a>MySQL中的SQL</h2><h3 id="遵循SQL标准部分"><a href="#遵循SQL标准部分" class="headerlink" title="遵循SQL标准部分"></a>遵循SQL标准部分</h3><ol>
<li><p>DDL、DML、DCL</p>
</li>
<li><p>支持关系数据库三级模式结构：</p>
<p>外模式：视图（View）和部分基本表（Table）</p>
<p>模式：若干基本表</p>
<p>内模式：若干存储文件</p>
<p>一个或多个基本表对应一个存储文件，一个表的若干索引存放在存储文件，存储文件的逻辑结构组成了MySQL的内模式；</p>
<p>数据库只存储视图的定义，不存储视图对应的数据，因此视图时一个<strong>虚表</strong></p>
</li>
</ol>
<h3 id="扩展部分"><a href="#扩展部分" class="headerlink" title="扩展部分"></a>扩展部分</h3><ol>
<li><p>常量</p>
<ul>
<li>字符串常量，””或’’括起来，ASCLL和Unicode</li>
<li>数值常量，整数和浮点数常量</li>
<li>十六进制通常指定为字符串常量，在其最前面有一个X或x</li>
<li>日期常量，’’</li>
<li>位，b’value’，value替换为一个二进制值</li>
<li>布尔值，TRUE(1) FLASE(0)</li>
<li>NULL, != 0 &amp;&amp; != ‘’</li>
</ul>
</li>
<li><p>变量</p>
<ul>
<li>系统变量<ul>
<li>全局变量</li>
<li>会话变量</li>
</ul>
</li>
<li>自定义变量<ul>
<li>用户变量</li>
<li>局部变量</li>
</ul>
</li>
</ul>
</li>
<li><p>运算符</p>
<ul>
<li>算术运算符：+ - * / %</li>
<li>位运算符：&amp; | ^ ~(位取反) &gt;&gt;(位右移) &lt;&lt;</li>
<li>比较运算符：= &gt; &lt; &gt;= &gt;= &lt;&gt;(不等于) !=(不等于) &lt;=&gt;(相等或都等于空)</li>
<li>逻辑运算符：NOT ! AND &amp;&amp; OR || XOR(逻辑异或)</li>
</ul>
</li>
<li><p>表达式</p>
<p>根据值的数据类型分为：字符型表达式、数值型表达式、日期型表达式</p>
</li>
<li><p>内置函数</p>
<ul>
<li>数学函数：ABS()、SORT()…</li>
<li>聚合函数：COUNT()…</li>
<li>字符串函数：ASCII()返回字符串第一个字符的 ASCII 码…</li>
<li>日期和时间函数：NOW()、YEAR()…</li>
<li>加密函数：ENCODE()、ENCRYPT()…</li>
<li>控制流程函数：IF()、IFNULL()…</li>
<li>格式化函数：FORMATE()…</li>
<li>类型转换函数：CAST()…</li>
<li>系统信息函数：USER()、VERSION()….</li>
</ul>
</li>
</ol>
<h2 id="数据定义"><a href="#数据定义" class="headerlink" title="数据定义"></a>数据定义</h2><h3 id="数据库定义"><a href="#数据库定义" class="headerlink" title="数据库定义"></a>数据库定义</h3><ol>
<li><p>创建数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE IF NOT EXISTS db_name </span><br><span class="line">CHARACTER SET utf8 </span><br><span class="line">COLLATE utf8_general_ci;</span><br></pre></td></tr></table></figure>

<p>CHARSET SET指定字符集，COLLATE指定字符集校对规则，IF NOT EXISTS可避免存在相同名称的数据库而报错。</p>
<p>DATABASE可以替换为SCHEMA，在MySQL5中，这两个语法功能是一致的。</p>
</li>
<li><p>选择数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE db_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALTER DATABASE db_name</span><br><span class="line">CHARACTER SET gb2312</span><br><span class="line">COLLATE gb2312_chinese_ci;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP DATABASE IF EXISTS test;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW DATABASES;</span><br></pre></td></tr></table></figure>

<p>将显示当前用户可查看的数据库列表，后面可跟上LIKE或WHERE关键字，实现模糊查询或条件查询。</p>
</li>
</ol>
<h3 id="常用数据类型"><a href="#常用数据类型" class="headerlink" title="常用数据类型"></a>常用数据类型</h3><table>
<thead>
<tr>
<th>类型</th>
<th>用途</th>
<th>大小</th>
</tr>
</thead>
<tbody><tr>
<td>INT</td>
<td>整型</td>
<td>4字节</td>
</tr>
<tr>
<td>TINYINT</td>
<td>短整型</td>
<td>1字节</td>
</tr>
<tr>
<td>BIGINT</td>
<td>长整型</td>
<td>8字节</td>
</tr>
<tr>
<td>FLOAT</td>
<td>单精度浮点型</td>
<td>4字节</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>双精度浮点型</td>
<td>8字节</td>
</tr>
<tr>
<td>DECIMAL(M,D)</td>
<td>精确小数，M为有效数字精度，D为小数点后位数，D&lt;=M</td>
<td>M(1-65); D(0-30)</td>
</tr>
<tr>
<td>DATE</td>
<td>YYYY-MM-DD</td>
<td></td>
</tr>
<tr>
<td>DATETIME</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td></td>
</tr>
<tr>
<td>CHAR</td>
<td>定长字符串</td>
<td>0-255字节</td>
</tr>
<tr>
<td>VARCHAR</td>
<td>变长字符串</td>
<td>0-65535字节</td>
</tr>
</tbody></table>
<ul>
<li><p>一个汉字占多少长度与编码有关：</p>
<p>UTF-8: 3个字节</p>
<p>GBK: 2个字节</p>
</li>
<li><p>varchar(n) 表示 n 个字符，无论汉字和英文，Mysql 都能存入 n 个字符，仅是实际字节长度有所区别</p>
</li>
</ul>
<h3 id="表定义"><a href="#表定义" class="headerlink" title="表定义"></a>表定义</h3><ol>
<li><p>创建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE db_name;</span><br><span class="line">CREATE TABLE IF NOT EXISTS tb_name(</span><br><span class="line">   id INT UNSIGNED AUTO_INCREMENT,</span><br><span class="line">   title VARCHAR(100) NOT NULL,</span><br><span class="line">   author VARCHAR(40) NOT NULL,</span><br><span class="line">   cTime DATETIME DEFAULT NOW(),</span><br><span class="line">   PRIMARY KEY ( id )</span><br><span class="line">)ENGINE=InnoDB;</span><br></pre></td></tr></table></figure>

<ul>
<li>若将CREATE TABLE改为CREATE TEMPORARY TABLE，可创建临时表，临时表只对创建者可见，并且在断开数据库连接时，MySQL将自动删除之</li>
<li>AUTO_INCREMENT，可以为表中整型列设置自增属性，当插入一个NULL或0到该列时，值会自动设置为该列最大值+1，初始值为1，每个表只能有一个AUTO_INCREMENT列，并且必须被索引。</li>
<li>当INSERT一个值到AUTO_INCREMENT列时，INSERT的值会覆盖自增长的值，并且后续的增量将基于INSERT的值</li>
<li>DEFAULT可以为该列指定默认值</li>
<li>若不指定NOT NULL，该列默认允许NULL</li>
<li>ENGINE=引擎类型（可选）</li>
</ul>
</li>
<li><p>更新表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE db_name.tb_name</span><br><span class="line">ADD COLUMN publisher VARCHAR(20) NOT NULL AFTER author;</span><br></pre></td></tr></table></figure>

<p>ADD [COLUMN, PRIMARY KEY, FOREIGN KEY,  INDEX]，分别为表添加列，主键，外键，索引</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE db_name.tb_name</span><br><span class="line">CHANGE COLUMN publisher pName CHAR(20) NULL;</span><br></pre></td></tr></table></figure>

<p>CHANGE COLUMN：修改列名、数据类型、是否为空、默认值、位置移动等</p>
<p>ALTER COLUMN：设置或删除列的默认值（操作速度非常快），删除加上DROP DEFAULT</p>
<p>MODIFY COLUMN：除了不能给列重命名之外，和CHANGE COLUMN是一样的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE db_name.tb_name</span><br><span class="line">DROP COLUMN publisher;</span><br></pre></td></tr></table></figure>

<p>DROP [COLUMN, PRIMARY KEY, FOREIGN KEY,  INDEX]，分别为卸除表的列及其所有数据，主键，外键，索引</p>
</li>
<li><p>重命名表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RENAME TABLE tb1_name TO tb1_new_name, tb2_name TO tb2_new_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS tb_name;</span><br></pre></td></tr></table></figure>

<ul>
<li>删除临时表DROP TEMPORARY TABLE</li>
<li>最后加上关键字RESTRICT表示，确保只有不存在相关视图和完整性约束的表才能删除</li>
<li>最后加上关键字CASCADE表示，任何相关视图和完整性约束一并被删除</li>
</ul>
</li>
<li><p>查看表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USE db_name;</span><br><span class="line">SHOW TABLES;</span><br></pre></td></tr></table></figure>

<p>显示数据库所有表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHOW COLUMNS FROM tb_name FROM test;</span><br><span class="line">DESCRIBE tb_name;</span><br></pre></td></tr></table></figure>

<p>显示表结构的两种方式，第一种方式FROM和IN关键字可互换，第二种方式DESCRIBE可简写为DESC</p>
</li>
</ol>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><h4 id="索引概述"><a href="#索引概述" class="headerlink" title="索引概述"></a>索引概述</h4><p>索引实质上是，一张<strong>描述索引列的列值与原表中记录行之间一一对应关系的</strong>有序表。</p>
<p>在列上创建了索引之后，查找数据时可以直接根据该列上的索引找到对应记录行的位置，从而快速地查找到数据。</p>
<p>过多使用索引会增加系统开销，因为索引存在一些弊端：</p>
<ol>
<li>索引是以文件形式存储地，DBMS会将一个表地所有索引保存在同一个索引文件中。如果拥有大量索引，索引文件可能会比数据文件更快地达到<em>最大文件尺寸</em>。尤其是在一个大表上创建了多种组合索引，索引文件会膨胀得非常快。</li>
<li>索引会降低表的更新速度，更新表中索引列上的数据时，索引会被自动更新，由此降低INSERT、UPDATE、DELETE和其他写入操作的效率。表中的所有越多，更新表的时间就会越长。</li>
</ol>
<p>根据具体用途，索引在逻辑上通常包含如下几类：</p>
<ol>
<li><p>普通索引（INDEX）</p>
<p>最基本的索引类型，没有任何限制，使用关键字INDEX或KEY</p>
</li>
<li><p>唯一性索引（UNIQUE）</p>
<p>和普通索引基本相同，并且索引列中所有值都只能出现一次，使用关键字UNIQUE</p>
</li>
<li><p>主键（PRIMARY KEY）</p>
<p>主键是一种唯一性索引，且不能有空值，每个表只能有一个主键，使用关键字PRIMARY KEY</p>
</li>
</ol>
<p><em>单列索引</em>很好理解，就是一个只包含原表的一个列；而<em>组合索引</em>（也称为多列索引或复合索引）就是原表中的多列共同组成的一个索引。</p>
<p>一个组合索引实质上为表的查询提供了多个索引，例如，在一个表上创建了一个组合索引(col1, col2, col3)，在实际的查询中，实际上可能是三个索引来加快查询速度：单列索引(col1)、组合索引(col1, col2)、组合索引(col1, col2, col3)</p>
<h4 id="索引定义"><a href="#索引定义" class="headerlink" title="索引定义"></a>索引定义</h4><ol>
<li><p>索引的创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX index_name</span><br><span class="line">ON table_name(col_name1, col_name2,...);</span><br></pre></td></tr></table></figure>


</li>
</ol>
<ul>
<li><p>若创建唯一性索引，使用CREATE UNIQUE INDEX</p>
</li>
<li><p>通常将查询语句中的WHERE子句和JOIN子句里出现的列作为索引列</p>
</li>
<li><p>col_name (length)，指定使用列的前length个字符来创建索引，节省磁盘空间</p>
</li>
<li><p>col_name ASC|DESC，指定索引按升序还是降序排列，默认ASC升序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tb_name</span><br><span class="line">(</span><br><span class="line">	...,</span><br><span class="line">	INDEX index_name(col3),</span><br><span class="line">	PRIMARY KEY(col1, col2),</span><br><span class="line">	UNIQUE index_name(col4)</span><br><span class="line">    FOREIGN KEY index_name(col5, ...)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>关键字KEY和INDEX为同义词，可以互换</p>
</li>
<li><p>定义主键和UNIQUE键或外键时，可以在前面加上CONSTRAINT key_name，定义一个名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE tb_name</span><br><span class="line">ADD INDEX|UNIQUE|PRIMARY KEY|FOREIGN KEY ...</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li>…语法同上</li>
</ul>
<ol start="2">
<li><p>索引的查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW INDEX FROM table_name FROM db_name</span><br></pre></td></tr></table></figure>

<ul>
<li>SHOW INDEX|INDEXES|KEYS</li>
<li>FROM可替换为IN</li>
<li>最后可以跟WHERE</li>
</ul>
</li>
<li><p>索引的删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP INDEX index_name ON table_name</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE table_name</span><br><span class="line">DROP PRIMARY KEY</span><br><span class="line">DROP INDEX index_name</span><br><span class="line">...;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="数据更新"><a href="#数据更新" class="headerlink" title="数据更新"></a>数据更新</h3><ol>
<li><p>插入数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO tb_name(col1, col2, ...)</span><br><span class="line">VALUES (expr|DEFAULT)</span><br></pre></td></tr></table></figure>

<ul>
<li>expr表示一个常量、变量、NULL或表达式，数据类型须和列保持一致，字符型须用单引号括起</li>
<li>如果列已指定默认值，可以用DEFAULT插入该列默认值，否则用DEFAULT会报错</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO tb_name</span><br><span class="line">SET col1=expr|DEFAULT, col2=expr|DEFAULT,...</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO tb_name(col1, col2, ...)</span><br><span class="line">SELECT col1, col2 ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM tb_name</span><br><span class="line">WHERE where_condition</span><br><span class="line">ORDER BY ...</span><br><span class="line">LIMIT row_count;</span><br></pre></td></tr></table></figure>

<ul>
<li>ORDER BY和LIMIT一般连用</li>
<li>ORDER BY，各行按照子句中指定的顺序进行删除</li>
<li>LIMIT row_count用于告知服务器在控制命令被返回到客户端前被删除的行的最大值（本次删除，最多删除多少条记录）</li>
</ul>
</li>
<li><p>修改数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UPDATE tb_name</span><br><span class="line">SET col1=expr|DEFAULT, col2=expr|DEFAULT,...</span><br><span class="line">WHERE where_condition</span><br><span class="line">ORDER BY ...</span><br><span class="line">LIMIT row_count;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="数据查询"><a href="#数据查询" class="headerlink" title="数据查询"></a>数据查询</h3><p>要素过多，暂略，待日后补充</p>
<h4 id="LIMITE"><a href="#LIMITE" class="headerlink" title="LIMITE"></a>LIMITE</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LIMIT offset, rowcount</span><br><span class="line">LIMIT rowcount OFFSET offset</span><br></pre></td></tr></table></figure>

<ul>
<li>offset为可选项，默认为数字0，用于指定返回数据的第一行，在SELECT语句<em>结果集</em>中的偏移量</li>
<li>rowcount用于指定返回数据的行数，大于实际能返回的行数时，返回能返回的数据行</li>
<li>综上，LIMIT语句含义是，从第offset+1行开始，取row_count行</li>
</ul>
<p>例如，在数据库crm的表customers中，查找从第5位客户开始的3位客户的id和姓名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT cust_id, cust_name FROM crm.customers</span><br><span class="line">ORDER BY cust_id</span><br><span class="line">LIMIT 4, 3;</span><br></pre></td></tr></table></figure>

<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><h4 id="视图概述"><a href="#视图概述" class="headerlink" title="视图概述"></a>视图概述</h4><ul>
<li>视图(View)对应三级模式中的<em>外模式</em></li>
<li>不是真实的表，是一张虚拟表，其结构和数据建立在对真实表的查询基础上</li>
<li>视图的数据式在引用视图时动态生成的，其自身不存储数据</li>
<li>与基本表一样可以增、删、改、查</li>
<li>视图的优点有：<ol>
<li>集中分散数据</li>
<li>简化查询语句</li>
<li>重用SQL语句</li>
<li>保护数据安全</li>
<li>共享所需数据</li>
<li>更改数据格式</li>
</ol>
</li>
</ul>
<h4 id="视图定义"><a href="#视图定义" class="headerlink" title="视图定义"></a>视图定义</h4><ol>
<li><p>创建视图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW view_name (column_list)</span><br><span class="line">AS select_statement</span><br></pre></td></tr></table></figure>

<ul>
<li>view_name指定视图名称，不能与其他表和视图同名</li>
<li>column_list是可选项，为视图中每个列指定名称，列名数量等于SELECT语句结果集的列数</li>
<li>select_statment就是创建视图的SELECT语句</li>
</ul>
<p>例如创建一行王姓客户信息的视图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW customer_wang_view</span><br><span class="line">AS</span><br><span class="line">SELECT * FROM crm.customers</span><br><span class="line">WHERE cust_name LIKE &apos;王%&apos;</span><br><span class="line">WITH CHECK OPTION;</span><br></pre></td></tr></table></figure>

<ul>
<li>WITH CHECK OPTION是可选项，强制视图上执行的所有数据修改语句都必须符合由 select_statement 设置的准则。  比如，如果用INSERT语句向这个视图添加一个名叫’张飞’的客户就会报错。</li>
<li>WITH CHECK OPTION一句话解释：通过视图进行的修改，必须保证能通过该视图看到修改后的结果。</li>
</ul>
</li>
<li><p>删除视图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP VIEW IF EXISTS view_name1, viw_name2...</span><br></pre></td></tr></table></figure>

<ul>
<li>最后可以加上关键字RESTRICT和CASCAD，和删除表时同样的效果</li>
</ul>
</li>
<li><p>修改视图定义</p>
<p>和创建视图类似，吧CREATE改为ALTER即可</p>
</li>
<li><p>查看视图定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE VIEW view_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新视图数据注意事项</p>
<ul>
<li>INSERT：当视图依赖于多个表时，无法INSERT；当视图WITH CHECK OPTION时，不满足视图WHERE条件也无法INSERT</li>
<li>UPDATE：当视图依赖于多个表时，一次UPDATE只能改变一个基本表的数据</li>
<li>DELETE：当视图依赖于多个表时，无法DELETE</li>
</ul>
</li>
</ol>
<h2 id="数据库编程"><a href="#数据库编程" class="headerlink" title="数据库编程"></a>数据库编程</h2><p>实现多条SQL，处理多个数据表的需求。</p>
<p>常用的两种数据库编程是存储过程和存储函数。</p>
<h4 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h4><h5 id="存储过程概述"><a href="#存储过程概述" class="headerlink" title="存储过程概述"></a>存储过程概述</h5><p>存储过程是一组为了完成某项特定功能的SQL语句集，实质是存储在数据库中的代码，由声明式SQL语句（CREATE、UPDATE、SELECT）和过程式SQL语句（IF…THEN…ELSE）组成。</p>
<p>这组语句集经过编译后存储在数据库中，用过通过指定的名字调用，如果该存储过程带有参数，则须给定参数。</p>
<p>在不同的应用程序或平台执行相同的功能时，存储过程尤为适合。</p>
<p>存储过程的优点：</p>
<ol>
<li>增强SQL语言的功能和灵活性</li>
<li>良好的封装性</li>
<li>高性能</li>
<li>可减少网络流量</li>
<li>存储过程作为一种安全机制来确保数据库的安全性和数据的完整性</li>
</ol>
<h5 id="存储过程操作"><a href="#存储过程操作" class="headerlink" title="存储过程操作"></a>存储过程操作</h5><ol>
<li><p>创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br></pre></td></tr></table></figure>


</li>
</ol>
<ul>
<li><p>存储过程的结束符号时;，SQL语句的结束符号也是;，为了避免只执行一条SQL，通过DELIMITER命令，修改SQL语句的结束符，$$可以为任意符号，处理完存储过程后，再通过 DELIMITER ; 修改回来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE sp_name(IN param_name1 type, OUT param_name2 type, INOUT param_name3 type, ...)</span><br><span class="line">BEGIN</span><br><span class="line">routine_body</span><br><span class="line">END</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>sp_name指定存储过程名称</p>
</li>
<li><p>括号里面是参数列表，type为参数类型，没有参数时也需要加上括号</p>
</li>
<li><p>IN、OUT、INOUT代表三种类型的参数：输入参数、输出参数、输入/输出参数</p>
</li>
<li><p>输入参数是传递给存储过程，输出参数是返回一个结果，输入/输出参数即可以充当输入也可以充当输出参数</p>
</li>
<li><p>参数的取名不要与数据表的列名相同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER @@</span><br><span class="line">CREATE PROCEDURE sp_update_sex(IN cid INT, IN csex CHAR(1))</span><br><span class="line">BEGIN</span><br><span class="line">	UPDATE customer SET cust_sex = csex WHERE cust_id = cid;</span><br><span class="line">END @@</span><br></pre></td></tr></table></figure>

</li>
</ul>
<ol start="2">
<li><p>局部变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DECLARE var_name type DEFAULT value</span><br></pre></td></tr></table></figure>

<ul>
<li>var_name指定变量名称，type指定变量数据类型，DEFAULT指定默认值，若没有则默认为NULL</li>
<li>局部变量只能在BEGIN…END语句块中的开头处声明</li>
<li>其他语句块不能使用</li>
<li>局部变量和用户变量区别是，用户变量声明时，在其名称前使用@符号，已声明的用户变量存在于整个会话之中</li>
</ul>
</li>
<li><p>SET语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET var_name = expr</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DECLARE i INT DEFAULT 0</span><br><span class="line">SET i = 1</span><br></pre></td></tr></table></figure>
</li>
<li><p>SELECT INTO</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT col_name, ... INTO var_name, ... table_expr</span><br></pre></td></tr></table></figure>

<ul>
<li>col_name指查询结果集的列名，var_name指要赋值的变量名，tale_expr指FROM..WHERE等部分</li>
<li>返回的结果集只能有一行数据</li>
</ul>
</li>
<li><p>IF…THEN…ELSE</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">IF monthly_value &lt;= 4000 THEN</span><br><span class="line">    SET income_level = &apos;Low Income&apos;;</span><br><span class="line">ELSEIF monthly_value &gt; 4000 AND monthly_value &lt;= 7000 THEN</span><br><span class="line">	SET income_level = &apos;Avg Income&apos;;</span><br><span class="line">ELSE</span><br><span class="line">    SET income_level = &apos;High Income&apos;;</span><br><span class="line">END IF;</span><br></pre></td></tr></table></figure>
</li>
<li><p>循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># WHILE语句演示</span><br><span class="line">DELIMITER $$</span><br><span class="line">CREATE PROCEDURE sp_while(IN in_count INT)</span><br><span class="line">BEGIN</span><br><span class="line">    DECLARE COUNT INT DEFAULT 0;</span><br><span class="line">    DECLARE SUM INT DEFAULT 0;</span><br><span class="line">    WHILE COUNT &lt; in_count DO</span><br><span class="line">        SET SUM = SUM + COUNT;</span><br><span class="line">        SET COUNT = COUNT + 1;</span><br><span class="line">    END WHILE;</span><br><span class="line">    SELECT SUM;</span><br><span class="line">END $$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">CALL sp_while(10); # 45 输出</span><br><span class="line"></span><br><span class="line">DROP PROCEDURE sp_while; #删除</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#REPEAT语句演示</span><br><span class="line">REPEAT</span><br><span class="line">Statements;</span><br><span class="line">UNTIL expression</span><br><span class="line">END REPEAT;</span><br></pre></td></tr></table></figure>

<ul>
<li>在REPEAT语句中不管是否满足给定条件，首先会执行一次statements, 然后再在UTILE中判断给定的条件是否成立，如果条件不成立会继续执行，如果条件成立则退出REPEAT循环。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#LOOP语句演示</span><br><span class="line">DELIMITER $$</span><br><span class="line">CREATE PROCEDURE sp_loop()</span><br><span class="line">BEGIN</span><br><span class="line">    DECLARE t INT DEFAULT 0;</span><br><span class="line">    loop_name:LOOP</span><br><span class="line">        SET t = t + 1;</span><br><span class="line">        IF t &gt; 10 THEN </span><br><span class="line">        	LEAVE loop_name;</span><br><span class="line">        END IF;</span><br><span class="line">    END LOOP loop_name;</span><br><span class="line">    </span><br><span class="line">    SELECT t;</span><br><span class="line">END $$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<ul>
<li>LEAVE相当于高级语言中的break，也可以使用ITERATE相当于continue</li>
</ul>
</li>
<li><p>游标</p>
<ul>
<li><p>SELECT INTO只能返回一行数据，使用SELECT语句可以返回多行数据，这时就需要使用游标处理多行数据。</p>
</li>
<li><p>游标是一个被SELECT语句检索出来的结果集。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#声明游标</span><br><span class="line">DECLARE cursor_name CURSOR FOR select_statement</span><br><span class="line">#打开游标</span><br><span class="line">OPEN cursor_name</span><br><span class="line">#读取数据</span><br><span class="line">FETCH cursor_name INTO var_name1, var_name2, ...</span><br><span class="line">#定义CONTINUE句柄（游标循环结束条件）</span><br><span class="line">DECLARE CONTINUE HANDLER FOR NOT FOUND</span><br><span class="line">SET done=TRUE</span><br><span class="line">#关闭游标</span><br><span class="line">CLOSE cursor_name</span><br></pre></td></tr></table></figure>

<ul>
<li>声明游标不能含有SELECT INTO子句</li>
<li>使用游标前必须打开游标，cursor_name指定要打开的游标</li>
<li>一个游标可能被打开多次，由于其他用户或应用程序可能谁是更新了数据，因此每次打开游标的结果集可能会不同</li>
<li>FETCH INTO是将游标指向的一行赋给一些变量</li>
<li>游标相当于一个指针，指向当前行的数据</li>
<li>当出现NOT FOUND时，done=TURE</li>
<li>每个游标不再使用是都应该被关闭，CLOSE语句会释放游标所使用的全部资源，没有关闭的游标<strong>不会</strong>在END语句时自动关闭</li>
<li>游标被关闭后如果重新OPEN，不需要再次声明</li>
<li>MySQL5中游标只能用于存储过程或存储函数</li>
<li>一个BEGIN END语句块中，每个游标名字唯一</li>
</ul>
</li>
<li><p>调用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CALL sp_name</span><br><span class="line">CALL another_sp_name(1, &apos;M&apos;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE IF EXISTS sp_name</span><br></pre></td></tr></table></figure>

<ul>
<li>RESTRICT|CASECADE同上</li>
</ul>
</li>
</ol>
<h4 id="存储函数"><a href="#存储函数" class="headerlink" title="存储函数"></a>存储函数</h4><p>和存储过程区别：</p>
<ul>
<li>存储函数不能拥有输出参数</li>
<li>调用存储函数不需要CALL语句</li>
<li>存储函数必须包含一条RETURN语句</li>
</ul>
<p>创建存储函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">CREATE FUNCTION get_cust_name(id int) </span><br><span class="line">    RETURNS VARCHAR(50)</span><br><span class="line">    #确定性函数用关键词DETERMINISTIC标识，表示函数的返回值完全由输入参数决定。</span><br><span class="line">    DETERMINISTIC</span><br><span class="line">BEGIN</span><br><span class="line">   DECLARE cust_name VARCHAR(50);</span><br><span class="line">   SET cust_name = (SELECT cust_name from customer where cust_id=id);</span><br><span class="line">   RETURN (name);</span><br><span class="line">end$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<p>调用存储函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT get_cust_name(8);</span><br></pre></td></tr></table></figure>

<p>删除存储函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP FUNCTION IF EXISTS get_cust_name;</span><br></pre></td></tr></table></figure>






                    </article>
                    


    <blockquote id="date-expire-notification" class="post-expired-notify">本文最后更新于 <span id="date-expire-num"></span> 天前，文中所描述的信息可能已发生改变</blockquote>
    <script>
        var dateUpdate = Date.parse("2019-10-18");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    </script>


<p class="post-footer-info mb-0 pt-0">本文发表于&nbsp;<time datetime="2019-10-06T15:47:42.000Z" itemprop="datePublished">2019-10-06</time>

    , 最后修改于&nbsp;<time datetime="2019-10-17T16:00:31.797Z" itemprop="dateModified">2019-10-18</time>

</p>
<p class="post-footer-info mb-0 pt-2">

<span class="post-categories-list mt-2">


<a class="post-categories-list-item" href='/categories/数据库系统原理/'>数据库系统原理</a>

</span>



<span class="post-tags-list mt-2">


<a class="post-tags-list-item" href="/tags/MySQL/" rel="tag">#&nbsp;MySQL</a>

<a class="post-tags-list-item" href="/tags/数据库/" rel="tag">#&nbsp;数据库</a>

</span>


</p>

                </div>
                
<div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/2019/11/12/C-之泛型/" rel="prev">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">C#之泛型</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
        <li class="page-item page-next">
            <a href="/2019/10/04/数据库设计/" rel="next">
                <div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">数据库设计</div>
            </a>
        </li>
    
</ul>
</div>

                
                    <!-- # Comment # -->
                    
                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span data-year></span>
        <a class="footer-copyright-a" href="https://boysg.github.io">小尹的博客</a>
    </p>
    <!-- footer custom text -->
    <p class="footer-text mb-0">
    
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        
            
    <!-- Busuanzi User Views -->
    <span id="busuanzi_container_site_uv" hidden>
        <span></span>
        <span id="busuanzi_value_site_uv"></span>
        <span>Viewers</span>
        
            <span>|</span>
        
    </span>



        
        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="external nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="external noopener">Suka</a>
    </p>
</footer>

        

        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};



    /* Copyright */
    var copyrightNow = new Date().getFullYear();
    var copyrightContent = document.querySelector('span[data-year]')
    
        copyrightSince = 2019;
        if (copyrightSince === copyrightNow) {
            copyrightContent.textContent = copyrightNow
        } else {
            copyrightContent.textContent = copyrightSince + ' - ' + copyrightNow
        }
    



/* Cnosole Log */
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.3 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');
</script>

<!-- vanilla-lazyload -->

    <script src="/lib/vanilla-lazyload/lazyload.min.js" async></script>



    <!-- Busuanzi -->
    
    <script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" async></script>


<!-- Offset -->







<!-- gallery.js -->


<!-- Comment -->


<!-- ### Custom Footer ### -->


    </body>

</html>